(target-module-activity-tracking)=
# Activity Tracking
The activity tracking module processes [camera](target-node-spinnakervideosource) frame events to compute motion activity or motion energy within a specified region of interest.
This measure of general activity is particularly useful for distinguishing between periods of static inactivity (such as sleep) and static activity (such as grooming).

## Nodes
### ActivityTracking 
The `ActivityTracking (Aeon.Vision)` node accepts frame events generated by a [camera](target-node-spinnakervideosource) and is used to compute motion activity or motion energy within a region of interest. 
Specifically, background subtraction is performed on the input camera frames based on a single frame history. The raw sum of absolute pixel intensity changes is then computed.

#### Inputs
None

#### Outputs 
<!-- Moved into this section from description, check if correct -->
A timestamped `double` describing the raw, frame-by-frame pixel intensity changes within the region of interest.

#### Properties
##### General
| Property name | Description                                               |
|---------------|-----------------------------------------------------------|
| **Region**         | An array of four `OpenCV.NET.Points`. These define the corners (anti-clockwise from top left) of the region of interest     |
| **ThresholdValue** | The lower threshold for pixel intensity differences to be included in the sum activity. Should be set to the pixel noise |

##### Subjects
Events from the node are published to `Subjects`. 
Here you set the names used for these `Subjects` to identify events for this node for a specific region of interest.
Each of these `Subjects` becomes accessible in the Bonsai editor's toolbox anywhere in the workflow using the name set here.

###### Device event subjects
| Subject name      | Type        | Description                   |
|-------------------|-------------|-------------------------------|
| **TrackingEvents**   | `Harp.Timestamped<double>` | The `Subject` to which the result describing absolute changes in pixel intensities will be published to |

#### Usage
Create a `GroupWorkflow`.
Inside, place an `ActivityTracking (Aeon.Vision)` node and connect it to the `WorkflowOutput`. 
Using a `SubscribeSubject`, e.g. "CameraTop", subscribe to the target [camera's](target-module-camera) "FrameEvents" `Subject` and connect it to the `ActivityTracking` node.

:::workflow
![ActivityTracking](../../workflows/activityTracking.bonsai)
:::

As with [`InRange (Aeon.Acquisition)`](target-node-inrange), more than one region of interest can be defined using multiple `GroupWorkflows`, each containing a separate instance of `ActivityTracking (Aeon.Vision)`.

<!-- To be completed 
## GUI
Description of any user interface components and visualisers.

## Logging
Information on logging functionalities, nodes involved, and schemas for recorded data.

**Data schema**

| Register name         | Access | Address | Type    | Mask type          | Description                                   |
|-----------------------|--------|---------|---------|--------------------|-----------------------------------------------|
| **Register1**         | Access | Address | `Type`  | Mask               | Description of Register1                      |
| **Register2**         | Access | Address | `Type`  | Mask               | Description of Register2                      |

(For not virtual harp devices) a full list of the available registers for the `device name` see the corresponding [device.yml](link-to-harprepo-device.yml)

## State persistence
Information on state recovery or persistence requirements, if applicable.

## Alerts
Explanation of any alert configurations and links to guides or further configuration steps.
-->