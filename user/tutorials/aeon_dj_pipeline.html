
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>DataJoint pipeline for Aeon &#8212; Aeon v0.0.17 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=8f2a1f02" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/custom.css?v=9651da53" />
  
  <!-- So that users can add custom icons -->
  <script src="../../_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="../../_static/documentation_options.js?v=c89ffb51"></script>
    <script src="../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../_static/design-tabs.js?v=f930bc37"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'user/tutorials/aeon_dj_pipeline';</script>
    <script src="../../_static/js/workflow.js?v=1800024c"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="General experimental workflow infrastructure" href="general_experimental_workflow.html" />
    <link rel="prev" title="Tutorials" href="../tutorials.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>
<aside class="bd-header-announcement" aria-label="Announcement">
  <div class="bd-header-announcement__content">This website is currently under active development. Please report any issues on <a href='https://github.com/SainsburyWellcomeCentre/aeon_docs/issues'>GitHub</a>.</div>
</aside>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="../../index.html">
  
  
  
  
  
  
    <p class="title logo__title">Aeon v0.0.17</p>
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../getting_started/index.html">
    Getting Started
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="../index.html">
    User Guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../contributor/index.html">
    Contributor’s Guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../reference/index.html">
    Reference
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../about/index.html">
    About
  </a>
</li>

  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
        </div>
      
      
        <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/SainsburyWellcomeCentre/aeon_docs" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
    </div>
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../getting_started/index.html">
    Getting Started
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="../index.html">
    User Guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../contributor/index.html">
    Contributor’s Guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../reference/index.html">
    Reference
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../about/index.html">
    About
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/SainsburyWellcomeCentre/aeon_docs" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><ul class="current nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../aeon_modules.html">Aeon Modules</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../aeon_modules/hardware.html">Hardware Assembly</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../aeon_modules/hardware/commutation_translation.html">Commutation-Translation System</a></li>
<li class="toctree-l3"><a class="reference internal" href="../aeon_modules/hardware/foraging_patch.html">Foraging Patch</a></li>
<li class="toctree-l3"><a class="reference internal" href="../aeon_modules/hardware/habitat.html">Habitat</a></li>
<li class="toctree-l3"><a class="reference internal" href="../aeon_modules/hardware/nest.html">Nest</a></li>
<li class="toctree-l3"><a class="reference internal" href="../aeon_modules/connections/camera.html">Camera Wiring Schematic</a></li>
<li class="toctree-l3"><a class="reference internal" href="../aeon_modules/connections/camera_controller.html">Camera Controller Wiring Schematic</a></li>
<li class="toctree-l3"><a class="reference internal" href="../aeon_modules/connections/commutation_translation_system.html">Commutation-Translation System Wiring Schematic</a></li>
<li class="toctree-l3"><a class="reference internal" href="../aeon_modules/connections/foraging_patch.html">Foraging Patch Wiring Schematic</a></li>
<li class="toctree-l3"><a class="reference internal" href="../aeon_modules/connections/foraging_patch_output_expander.html">Foraging Patch Output Expander Wiring Schematic</a></li>
<li class="toctree-l3"><a class="reference internal" href="../aeon_modules/connections/microphone.html">Microphone Wiring Schematic</a></li>
<li class="toctree-l3"><a class="reference internal" href="../aeon_modules/connections/rfid_reader.html">RFID Reader Wiring Schematic</a></li>
<li class="toctree-l3"><a class="reference internal" href="../aeon_modules/connections/sound_card.html">Sound Card Wiring Schematic</a></li>
<li class="toctree-l3"><a class="reference internal" href="../aeon_modules/connections/timestamp_generator.html">Timestamp Generator Wiring Schematic</a></li>
<li class="toctree-l3"><a class="reference internal" href="../aeon_modules/connections/weighing_scale.html">Weighing Scale Wiring Schematic</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../aeon_modules/acquisition.html">Acquisition Modules</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../aeon_modules/acquisition/activity_tracking.html">Activity Tracking</a></li>
<li class="toctree-l3"><a class="reference internal" href="../aeon_modules/acquisition/alerts.html">Alerts</a></li>
<li class="toctree-l3"><a class="reference internal" href="../aeon_modules/acquisition/camera.html">Spinnaker Camera</a></li>
<li class="toctree-l3"><a class="reference internal" href="../aeon_modules/acquisition/camera_controller.html">Multi-Camera Controller</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../aeon_modules/acquisition/control_panel.html">Control Panel</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../aeon_modules/acquisition/control_panel/annotation_source_GUI.html">AnnotationSource</a></li>
<li class="toctree-l4"><a class="reference internal" href="../aeon_modules/acquisition/control_panel/button_source_GUI.html">ButtonSource</a></li>
<li class="toctree-l4"><a class="reference internal" href="../aeon_modules/acquisition/control_panel/environment_state_GUI.html">EnvironmentState</a></li>
<li class="toctree-l4"><a class="reference internal" href="../aeon_modules/acquisition/control_panel/experiment_properties_GUI.html">ExperimentProperties</a></li>
<li class="toctree-l4"><a class="reference internal" href="../aeon_modules/acquisition/control_panel/label_control_GUI.html">LabelControl</a></li>
<li class="toctree-l4"><a class="reference internal" href="../aeon_modules/acquisition/control_panel/subject_database.html">SubjectDatabase <!--TODO: Placeholder content--></a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../aeon_modules/acquisition/foraging_patch.html">Foraging Patch</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../aeon_modules/acquisition/foraging_patch/patch_dispenser.html">PatchDispenser</a></li>
<li class="toctree-l4"><a class="reference internal" href="../aeon_modules/acquisition/foraging_patch/pellet_monitor.html">PelletMonitor</a></li>
<li class="toctree-l4"><a class="reference internal" href="../aeon_modules/acquisition/foraging_patch/time_since_last_event.html">TimeSinceLastEvent</a></li>
<li class="toctree-l4"><a class="reference internal" href="../aeon_modules/acquisition/foraging_patch/time_spent_on_wheel.html">TimeSpentOnWheel</a></li>
</ul>
</details></li>
<li class="toctree-l3"><a class="reference internal" href="../aeon_modules/acquisition/logging.html">Logging</a></li>
<li class="toctree-l3"><a class="reference internal" href="../aeon_modules/acquisition/monitors.html">Device Synchronisation Monitors</a></li>
<li class="toctree-l3"><a class="reference internal" href="../aeon_modules/acquisition/nest.html">Nest</a></li>
<li class="toctree-l3"><a class="reference internal" href="../aeon_modules/acquisition/rfid_reader.html">RFID Reader</a></li>
<li class="toctree-l3"><a class="reference internal" href="../aeon_modules/acquisition/subject_tracking.html">Subject Tracking</a></li>
</ul>
</details></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../sample_datasets.html">Sample Datasets</a></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="../tutorials.html">Tutorials</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2 current active"><a class="current reference internal" href="#">DataJoint pipeline for Aeon</a></li>
<li class="toctree-l2"><a class="reference internal" href="general_experimental_workflow.html">General experimental workflow infrastructure</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../how_to.html">How-to Guides</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../how_to/dj_data_ingestion_and_processing.html">DataJoint pipeline: Data ingestion and processing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../how_to/dj_data_loading.html">Helper functions</a></li>

<li class="toctree-l2"><a class="reference internal" href="../how_to/dj_pipeline_local_deployment.html">DataJoint pipeline: On-premises deployment</a></li>
<li class="toctree-l2"><a class="reference internal" href="../how_to/dj_querying_data.html">DataJoint pipeline: Querying data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../how_to/hmm_example.html">Hidden Markov Model analysis of mouse behavioural syntax</a></li>
<li class="toctree-l2"><a class="reference internal" href="../how_to/io_api_example_copy.html">Data access using the low-level API</a></li>
<li class="toctree-l2"><a class="reference internal" href="../how_to/social_analysis1_static.html">Platform paper social experiment analysis: Part 1</a></li>
<li class="toctree-l2"><a class="reference internal" href="../how_to/social_analysis2.html">Platform paper social experiment analysis: Part 2</a></li>
</ul>
</details></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">

<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="../index.html" class="nav-link">User Guide</a></li>
    
    
    <li class="breadcrumb-item"><a href="../tutorials.html" class="nav-link">Tutorials</a></li>
    
    <li class="breadcrumb-item active" aria-current="page"><span class="ellipsis">DataJoint pipeline for Aeon</span></li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="datajoint-pipeline-for-aeon">
<span id="target-aeon-dj-pipeline"></span><h1>DataJoint pipeline for Aeon<a class="headerlink" href="#datajoint-pipeline-for-aeon" title="Link to this heading">#</a></h1>
<p><a class="reference external" href="https://www.datajoint.com/">DataJoint</a> is a framework for developing and executing structured data pipelines that organise data into a relational database.
The Aeon DataJoint pipeline, implemented in the <code class="docutils literal notranslate"><span class="pre">aeon_mecha</span></code> <a class="reference internal" href="../../getting_started/repositories.html#target-repositories"><span class="std std-ref">repository</span></a>, consists of a set of <a class="reference external" href="https://docs.datajoint.com/core/datajoint-python/0.14/concepts/principles/#">tables</a> designed to manage, contain, and process data generated by the <a class="reference internal" href="../../reference/api/aeon_acquisition.html#target-aeon-acquisition-reference"><span class="std std-ref">Aeon acquisition system</span></a>.</p>
<section id="pipeline-architecture">
<h2>Pipeline architecture<a class="headerlink" href="#pipeline-architecture" title="Link to this heading">#</a></h2>
<p>The following diagrams provide a high-level overview of the pipeline’s components and processes.</p>
<figure class="align-default" id="id1">
<span id="target-aeon-dj-pipeline-acquisition-fig"></span><a class="reference external image-reference" href="../../_images/datajoint_overview_acquisition_related_diagram.svg"><img alt="dj-overview-acquisition" src="../../_images/datajoint_overview_acquisition_related_diagram.svg" />
</a>
<figcaption>
<p><span class="caption-text">Data acquisition-related tables.</span><a class="headerlink" href="#id1" title="Link to this image">#</a></p>
</figcaption>
</figure>
<figure class="align-default" id="id2">
<span id="target-aeon-dj-pipeline-streams-fig"></span><a class="reference external image-reference" href="../../_images/datajoint_overview_data_stream_diagram.svg"><img alt="dj-overview-streams" src="../../_images/datajoint_overview_data_stream_diagram.svg" />
</a>
<figcaption>
<p><span class="caption-text">Data flow for various data streams.</span><a class="headerlink" href="#id2" title="Link to this image">#</a></p>
</figcaption>
</figure>
<figure class="align-default" id="id3">
<a class="reference external image-reference" href="../../_images/datajoint_overview_pyrat_related_diagram.svg"><img alt="dj-overview-pyrat" src="../../_images/datajoint_overview_pyrat_related_diagram.svg" />
</a>
<figcaption>
<p><span class="caption-text">Pyrat synchronisation process.</span><a class="headerlink" href="#id3" title="Link to this image">#</a></p>
</figcaption>
</figure>
<figure class="align-default" id="id4">
<span id="target-aeon-dj-pipeline-analysis-fig"></span><a class="reference external image-reference" href="../../_images/datajoint_analysis_diagram.svg"><img alt="dj-analysis" src="../../_images/datajoint_analysis_diagram.svg" />
</a>
<figcaption>
<p><span class="caption-text">Analysis tables.</span><a class="headerlink" href="#id4" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>As seen above, the pipeline is structured into hierarchical layers of tables, each classified into one of four tiers based on the origin of the data they contain:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">lookup</span></code>-tier (grey): Contains reference information defined a priori.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">manual</span></code>-tier (green): Contains data manually entered by the user.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">imported</span></code>-tier tables (purple): Contains data ingested from external sources such as raw data files.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">computed</span></code>-tier tables (red): Contains results from automated pipeline computations.</p></li>
</ul>
<p>Data flows through the pipeline in a top-down manner, driven by a combination of ingestion and computation routines. This layered organisation facilitates efficient data processing and modular analysis.</p>
</section>
<section id="automatic-table-definition">
<h2>Automatic table definition<a class="headerlink" href="#automatic-table-definition" title="Link to this heading">#</a></h2>
<p>Device tables (e.g. <code class="docutils literal notranslate"><span class="pre">streams.UndergroundFeeder</span></code>) and their corresponding data stream tables (e.g. <code class="docutils literal notranslate"><span class="pre">streams.UndergroundFeederDeliverPellet</span></code>, <code class="docutils literal notranslate"><span class="pre">streams.UndergroundFeederDepletionState</span></code>) are dynamically defined and written to the auto-generated <code class="docutils literal notranslate"><span class="pre">aeon.dj_pipeline.streams</span></code> module (<code class="docutils literal notranslate"><span class="pre">aeon/dj_pipeline/streams.py</span></code>).</p>
<p>The automatic table definition process is initiated during the ingestion of metadata for each <a class="reference internal" href="../../reference/glossary.html#term-Acquisition-Epoch"><span class="xref std std-term">acquisition epoch</span></a> and proceeds in four stages:</p>
<ol class="arabic simple">
<li><p><strong>Schema-driven device discovery</strong>: Experimental schemas (e.g. <code class="docutils literal notranslate"><span class="pre">social02</span></code>) defined in <code class="docutils literal notranslate"><span class="pre">aeon/schema/schemas.py</span></code> specify the available devices and their associated data streams (alongside the reader classes) for each experimental setup.</p></li>
<li><p><strong>Metadata integration</strong>: For each <a class="reference internal" href="../../reference/glossary.html#term-Acquisition-Epoch"><span class="xref std std-term">acquisition epoch</span></a>, actual device configurations are extracted from the <code class="docutils literal notranslate"><span class="pre">metadata.yml</span></code> file, which specifies the connected devices, tracking modules, environmental controls, and other system components used during that epoch.</p></li>
<li><p><strong>Catalogue population</strong>: Schema and metadata information are used to populate the catalogue tables (<code class="docutils literal notranslate"><span class="pre">streams.DeviceType</span></code>, <code class="docutils literal notranslate"><span class="pre">streams.StreamType</span></code>, <code class="docutils literal notranslate"><span class="pre">streams.Device</span></code>), which serve as registries to drive the automatic table definition process. To ensure that tables are generated only for relevant devices, only those present in both the schema and the metadata are included.</p></li>
<li><p><strong>Dynamic table definition</strong>: <code class="docutils literal notranslate"><span class="pre">aeon/dj_pipeline/utils/streams_maker.py</span></code> reads from the catalogue tables to define the actual device and stream table classes (e.g. <code class="docutils literal notranslate"><span class="pre">streams.UndergroundFeeder</span></code>, <code class="docutils literal notranslate"><span class="pre">streams.UndergroundFeederDeliverPellet</span></code>, <code class="docutils literal notranslate"><span class="pre">streams.UndergroundFeederDepletionState</span></code>) using predefined templates, and writes them to <code class="docutils literal notranslate"><span class="pre">aeon/dj_pipeline/streams.py</span></code>.</p></li>
</ol>
<p>This automatic table definition system enables the pipeline to handle diverse experimental setups by defining table classes on-demand based on the actual devices present in each experiment.
The actual database tables are then automatically created when DataJoint processes the <a class="reference external" href="https://docs.datajoint.com/core/datajoint-python/latest/design/tables/declare/#defining-a-table"><code class="docutils literal notranslate"><span class="pre">&#64;schema</span></code>-decorated</a> classes.</p>
</section>
<section id="core-tables">
<h2>Core tables<a class="headerlink" href="#core-tables" title="Link to this heading">#</a></h2>
<p>This section provides an overview of the core tables in the Aeon DataJoint pipeline, categorised by their primary function and the type of data they manage.</p>
<section id="experiment-and-data-acquisition">
<span id="target-aeon-dj-pipeline-acquisition-tables"></span><h3>Experiment and data acquisition<a class="headerlink" href="#experiment-and-data-acquisition" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">acquisition.Experiment</span></code> - This table stores meta information about Aeon experiments, including details such as the lab/room where the experiment is conducted, the participating subjects, and the directory storing the raw data.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">acquisition.Epoch</span></code> - This table records all <a class="reference internal" href="../../reference/glossary.html#term-Acquisition-Epoch"><span class="xref std std-term">acquisition epochs</span></a>, which are periods reflecting the on/off states of the hardware within the acquisition system, along with their associated configurations for any particular experiment listed in the <code class="docutils literal notranslate"><span class="pre">acquisition.Experiment</span></code> table.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">acquisition.Chunk</span></code> - The raw data acquired through the <a class="reference internal" href="../../reference/api/aeon_acquisition.html#target-aeon-acquisition-reference"><span class="std std-ref">acquisition system</span></a> is stored as a collection of files at hourly intervals, referred to as a <a class="reference internal" href="../../reference/glossary.html#term-Acquisition-Chunk"><span class="xref std std-term">chunk</span></a>.
This table records all time chunks and their associated raw data files for any particular experiment in the <code class="docutils literal notranslate"><span class="pre">acquisition.Experiment</span></code> table. Each chunk must only belong to a single <a class="reference internal" href="../../reference/glossary.html#term-Acquisition-Epoch"><span class="xref std std-term">epoch</span></a>.</p></li>
</ul>
</section>
<section id="video-data-and-position-tracking">
<span id="target-aeon-dj-pipeline-tracking-tables"></span><h3>Video data and position tracking<a class="headerlink" href="#video-data-and-position-tracking" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">qc.CameraQC</span></code> - This table records the quality control procedures applied to each <code class="docutils literal notranslate"><span class="pre">streams.SpinnakerVideoSource</span></code> (camera) in the experiment, such as identifying dropped frames in the video data.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">tracking.SLEAPTracking</span></code> - This table records the <a class="reference external" href="https://sleap.ai/#">SLEAP</a> position tracking of object(s) for each chunk of video recorded from a particular <code class="docutils literal notranslate"><span class="pre">streams.SpinnakerVideoSource</span></code> (<a class="reference internal" href="../aeon_modules/acquisition/camera.html#target-module-camera"><span class="std std-ref">camera device</span></a>).
Key <a class="reference external" href="https://docs.datajoint.com/core/datajoint-python/0.14/design/tables/master-part/#">part tables</a> include:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">PoseIdentity</span></code> - This table records the procedure that identifies the object being tracked (i.e. assigns an identity) and stores the name of the body part (<code class="docutils literal notranslate"><span class="pre">anchor_part</span></code>) used as the anchor point.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Part</span></code> - This table records the x, y positions of all body parts tracked using SLEAP.</p></li>
</ul>
</li>
</ul>
</section>
<section id="standard-analyses">
<span id="target-aeon-dj-pipeline-analysis-tables"></span><h3>Standard analyses<a class="headerlink" href="#standard-analyses" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">analysis.visit.Visit</span></code> and <code class="docutils literal notranslate"><span class="pre">analysis.visit.VisitEnd</span></code> - These tables record the start and end times of each <a class="reference internal" href="../../reference/glossary.html#term-Visit"><span class="xref std std-term">visit</span></a>, along with the associated <a class="reference internal" href="../../reference/glossary.html#term-Place"><span class="xref std std-term">place</span></a> and <code class="docutils literal notranslate"><span class="pre">Subject</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">analysis.block_analysis.Block</span></code> - This table records the start and end times of each <a class="reference internal" href="../../reference/glossary.html#term-Block"><span class="xref std std-term">block</span></a>, along with the associated <code class="docutils literal notranslate"><span class="pre">acquisition.Experiment</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">analysis.block_analysis.BlockAnalysis</span></code> - This table contains a higher-level aggregation of events and metrics occurring within a <a class="reference internal" href="../../reference/glossary.html#term-Block"><span class="xref std std-term">block</span></a>. Here, patch-related and subject-related metrics are computed separately, providing a detailed view of how different <code class="docutils literal notranslate"><span class="pre">streams.UndergroundFeeder</span></code>(s) and individual <code class="docutils literal notranslate"><span class="pre">Subject</span></code>(s) contribute to the overall experimental outcomes.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">analysis.block_analysis.BlockSubjectAnalysis</span></code> - This table focuses on the detailed analysis of individual <code class="docutils literal notranslate"><span class="pre">Subject</span></code>(s) within a <a class="reference internal" href="../../reference/glossary.html#term-Block"><span class="xref std std-term">block</span></a>, and considers each <code class="docutils literal notranslate"><span class="pre">Subject</span></code>’s interactions with each <code class="docutils literal notranslate"><span class="pre">streams.UndergroundFeeder</span></code> (food patch). Metrics such as total interaction time and overall time spent at the patch are computed. Key part tables include:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">Patch</span></code>: This table records the subject’s interactions with a particular food patch, detailing the time spent at the patch, the distance spun on the patch wheel, the number of pellets received, and the timing of pellet deliveries.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Preference</span></code>: This table records the subject’s preference for each food patch by computing cumulative preference metrics based on time spent at the patch and wheel distance spun.</p></li>
</ul>
</li>
</ul>
</section>
<section id="data-streams">
<span id="target-aeon-dj-pipeline-streams-tables"></span><h3>Data streams<a class="headerlink" href="#data-streams" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">streams.SpinnakerVideoSource</span></code> - This table records the placement and operation of a Spinnaker video source in an <code class="docutils literal notranslate"><span class="pre">acquisition.Experiment</span></code>, as well as metadata such as the installation time of the device. It facilitates the collection of video data, including frame counts and timestamps.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">streams.RfidReader</span></code> - This table records the placement and operation of an RFID reader in an <code class="docutils literal notranslate"><span class="pre">acquisition.Experiment</span></code>, as well as the installation time of the device. It facilitates the collection of RFID data, such as RFID tag detection counts, timestamps, and tag IDs.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">streams.WeightScale</span></code> - This table records the placement and operation of a weighing scale in an <code class="docutils literal notranslate"><span class="pre">acquisition.Experiment</span></code>, including its installation time and any relevant metadata. It facilitates the collection of raw and filtered weight measurements.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">streams.UndergroundFeeder</span></code> - This table records the operation of an underground food patch in an <code class="docutils literal notranslate"><span class="pre">acquisition.Experiment</span></code>, including its installation time and any relevant metadata. It facilitates the collection of various patch events and states, including beam breaks, pellet deliveries, and depletion states.</p></li>
</ul>
</section>
</section>
<section id="pipeline-operation-auto-ingestion-and-processing">
<h2>Pipeline operation: Auto ingestion and processing<a class="headerlink" href="#pipeline-operation-auto-ingestion-and-processing" title="Link to this heading">#</a></h2>
<p>The process begins by entering the meta-information about the experiment, such as the experiment name, participating subjects, cameras, and food patch configurations.</p>
<p>This information can either be input manually or automatically parsed from configuration YAML files.
To facilitate this, the following scripts handle both manual input and automated parsing for different types of experiments:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">aeon/dj_pipeline/create_experiments/create_experiment_02.py</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">aeon/dj_pipeline/create_experiments/create_socialexperiment.py</span></code></p></li>
</ul>
<p>This is a one-time operation per experiment.
In DataJoint, tables are written within the <a class="reference external" href="https://docs.datajoint.com/core/datajoint-python/0.13/reproduce/make-method/#"><code class="docutils literal notranslate"><span class="pre">make()</span></code></a> method, which generates and inserts new records based on data from upstream tables. The <a class="reference external" href="https://docs.datajoint.com/core/datajoint-python/0.14/compute/populate/#"><code class="docutils literal notranslate"><span class="pre">populate()</span></code></a> method automates the process of calling <code class="docutils literal notranslate"><span class="pre">make()</span></code> for all relevant tables.</p>
<p>The auto-ingestion and processing/computation routines are defined in <code class="docutils literal notranslate"><span class="pre">aeon/dj_pipeline/populate/worker.py</span></code>. Running the auto-processing routine is equivalent to executing the following four commands, which can be performed sequentially or in parallel using different processing threads:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">aeon_ingest</span> <span class="pre">pyrat_worker</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">aeon_ingest</span> <span class="pre">acquisition_worker</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">aeon_ingest</span> <span class="pre">streams_worker</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">aeon_ingest</span> <span class="pre">analysis_worker</span></code></p></li>
</ul>
<p>Since DataJoint operations are idempotent, the aforementioned routine or commands can safely be rerun if needed.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>The guides on <a class="reference internal" href="../how_to/dj_pipeline_local_deployment.html#target-dj-pipeline-deployment"><span class="std std-ref">deploying the Aeon DataJoint pipeline on-premises</span></a>, <a class="reference internal" href="../how_to/dj_data_ingestion_and_processing.html#target-dj-data-ingestion-processing"><span class="std std-ref">data ingestion and processing</span></a>, and <a class="reference internal" href="../how_to/dj_querying_data.html#target-dj-querying-data"><span class="std std-ref">data querying</span></a>.</p>
</div>
</section>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="../tutorials.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Tutorials</p>
      </div>
    </a>
    <a class="right-next"
       href="general_experimental_workflow.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">General experimental workflow infrastructure</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pipeline-architecture">Pipeline architecture</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#automatic-table-definition">Automatic table definition</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#core-tables">Core tables</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#experiment-and-data-acquisition">Experiment and data acquisition</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#video-data-and-position-tracking">Video data and position tracking</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#standard-analyses">Standard analyses</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#data-streams">Data streams</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pipeline-operation-auto-ingestion-and-processing">Pipeline operation: Auto ingestion and processing</a></li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/user/tutorials/aeon_dj_pipeline.md.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="../../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item"><p class="sphinx-version"></p>
    Created using <a href="https://sphinx-doc.org/">Sphinx</a> 8.2.3.
    <br/>
    </p>
    <p class="theme-version">
    Built with the
    <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a>
    0.16.1.
    </p></div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item"><div class="things-in-a-row">
    <a href="https://neurogears.org/">
        <img src="../../_static/images/light-logo-neurogears.png" alt="Sponsors" class="only-light img-sponsor"/>
        <img src="../../_static/images/dark-logo-neurogears.png" alt="Sponsors" class="only-dark img-sponsor"/>
    </a>
    <a href="https://www.datajoint.com/">
        <img src="../../_static/images/light-logo-datajoint.png" alt="Sponsors" class="only-light img-sponsor"/>
        <img src="../../_static/images/dark-logo-datajoint.png" alt="Sponsors" class="only-dark img-sponsor"/>
    </a>
    <a href="https://wellcome.org/">
        <img src="../../_static/images/light-logo-wellcome.png" alt="Sponsors" class="only-light img-sponsor"/>
        <img src="../../_static/images/dark-logo-wellcome.png" alt="Sponsors" class="only-dark img-sponsor"/>
    </a>
    <a href="https://www.sainsburywellcome.org/web/">
        <img src="../../_static/images/light-logo-swc.png" alt="Sponsors" class="only-light img-sponsor"/>
        <img src="../../_static/images/dark-logo-swc.png" alt="Sponsors" class="only-dark img-sponsor"/>
    </a>
    <a href="https://www.ucl.ac.uk/">
        <img src="../../_static/images/light-logo-ucl.png" alt="Sponsors" class="only-light img-sponsor"/>
        <img src="../../_static/images/dark-logo-ucl.png" alt="Sponsors" class="only-dark img-sponsor"/>
    </a>
    <a href="https://www.ucl.ac.uk/gatsby/gatsby-computational-neuroscience-unit">
        <img src="../../_static/images/light-logo-gatsby.png" alt="Sponsors" class="only-light img-sponsor"/>
        <img src="../../_static/images/dark-logo-gatsby.png" alt="Sponsors" class="only-dark img-sponsor"/>
    </a>
    <a href="https://www.ukri.org/councils/bbsrc/">
        <img src="../../_static/images/light-logo-bbsrc.png" alt="Sponsors" class="only-light img-sponsor"/>
        <img src="../../_static/images/dark-logo-bbsrc.png" alt="Sponsors" class="only-dark img-sponsor"/>
    </a>
    <a href="https://www.simonsfoundation.org/">
        <img src="../../_static/images/light-logo-simons.png" alt="Sponsors" class="only-light img-sponsor"/>
        <img src="../../_static/images/dark-logo-simons.png" alt="Sponsors" class="only-dark img-sponsor"/>
    </a>
</div></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>